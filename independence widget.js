var doodle=function(){Function.prototype.bind=Function.prototype.bind||function(t){var i=this;return function(){return i.apply(t,arguments)}};var e=document.documentElement,o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){setTimeout(t,17)},n=Math.PI/2,a={},h=function(t){return this.canvas=t,this.ctx=t.getContext("2d"),this.objects=[],this.restart_timeout=1e3,this.paused=!1,this.destroyed=!1,this};new Date;h.prototype.frame=function(){if(!this.destroyed){for(var t in this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.objects)1==this.objects[t].destroyed?this.objects.splice(t,1):this.objects[t].tick(this.ctx);if(0==this.objects.length){var i=this;setTimeout(function(){i.restart_timeout,i.setup(),i.frame()},this.restart_timeout)}else this.paused||o(this.frame.bind(this))}},h.prototype.setup=function(){this.objects.push(t(this))},h.prototype.destroy=function(){this.destroyed=!0,this.objects=[]};var r=function(t,i){this.x=t,this.y=i,this.planes=[]};r.prototype.addPlane=function(t,i,s){var e=this.x+t,o=this.y+i,h=new d(a.jet_img,e,o,s,t,i);return this.planes.push(h),h},r.prototype.travelTo=function(t,i,s){var e;for(var o in this.planes)(e=this.planes[o]).travelTo(e.formation_x+t,e.formation_y+i,s)},r.prototype.tick=function(t){for(var i in this.planes)this.planes[i].destroyed?this.planes.splice(i,1):this.planes[i].tick(t);0==this.planes.length&&this.destroy()},r.prototype.destroy=function(){this.destroyed=!0};var t=function(t){var i=.5<Math.random(),s=i?t.ctx.canvas.height:10+(t.ctx.canvas.height-10)*Math.random(),e=i?(t.ctx.canvas.width/2-10)*Math.random():10,o=new r(e,s);o.addPlane(0,0,"255, 153, 51"),o.addPlane(50,-50,"222, 222, 222"),o.addPlane(100,0,"0, 128, 0");var h=t.ctx.canvas.height-s,a=t.ctx.canvas.width-e;return o.travelTo(a,h,3+3*Math.random()),o},d=function(t,i,s,e,o,h){return this.img=t,this.x=i,this.y=s,this.formation_x=o,this.formation_y=h,this.smoke_particles_list=[],this.smoke_rgb=e,this.destroy_plane=!1,this.pather=new c,this};d.prototype.draw=function(t){t.save();var i=Math.atan(this.pather.slope)+n;for(var s in t.translate(this.x,this.y),t.rotate(i),t.drawImage(this.img,0,0),t.restore(),this.smoke_particles_list)1==this.smoke_particles_list[s].destroyed?this.smoke_particles_list.splice(s,1):this.smoke_particles_list[s].draw(t)},d.prototype.travelTo=function(t,i,s){this.pather.createPath(this.x,this.y,t,i,s)},d.prototype.tick=function(t){this.pather.move();var i=Math.atan(this.pather.slope)+n,s=-this.formation_x+this.formation_x*Math.cos(i)-this.formation_y*Math.sin(i),e=-this.formation_y+this.formation_x*Math.sin(i)+this.formation_y*Math.cos(i);if(this.x=this.pather.x+s,this.y=this.pather.y+e,this.smoke_particles_list.length<100&&!this.destroy_plane){var o=(11+2*Math.random())*Math.cos(i)-(29+4*Math.random())*Math.sin(i),h=(11+2*Math.random())*Math.sin(i)+(29+4*Math.random())*Math.cos(i),a=new l(this.x+o,this.y+h,this.smoke_rgb);this.smoke_particles_list.push(a)}this.draw(t);this.x>t.canvas.width+50||this.y>t.canvas.height+50||this.x<-50||this.y<-50?this.destroy_plane=!0:this.destroy_plane=!1,this.destroy_plane&&0==this.smoke_particles_list.length&&this.destroy()},d.prototype.destroy=function(){this.destroyed=!0};var c=function(){this.speed=2.5,this.slope=null,this.x=0,this.y=0,this.delta_x=0,this.delta_y=0};c.prototype.createPath=function(t,i,s,e,o){this.x=t,this.y=i,this.delta_x=s-t,this.delta_y=e-i,this.slope=this.delta_y/this.delta_x,this.speed=o},c.prototype.setSpeed=function(t){this.speed=t},c.prototype.move=function(){this.x=this.x+Math.cos(Math.atan(this.slope))*this.speed,this.y=this.y+Math.sin(Math.atan(this.slope))*this.speed};var p,l=function(t,i,s){this.x=t,this.y=i,this.opacity=.5,this.radius=2+Math.random(),this.rgb=s};l.prototype.draw=function(t){t.save(),t.beginPath(),t.fillStyle="rgba("+this.rgb+","+this.opacity+")",t.shadowColor="rgba("+this.rgb+",1)",t.arc(this.x,this.y,this.radius,0,2*Math.PI,!0),t.fill(),this.radius=this.radius+.05,this.opacity=this.opacity-.005,this.opacity<=0&&(this.destroyed=!0),t.restore()};return{init:function(t){var i=document.createElement("canvas");i.id="canvas_doodle",i.height=window.innerHeight||e.clientHeight,i.width=window.innerWidth||e.clientWidth;var s=i.style;s.position="fixed",s.top=0,s.left=0,s.zIndex=1138,s.pointerEvents="none",document.body.appendChild(i),p=new h(i),a.jet_img=new Image,a.jet_img.src=t,a.jet_img.onload=function(){p.setup(),o(p.frame.bind(p))}},destroy:function(){p.destroy(),setTimeout(function(){document.body.removeChild(document.getElementById("canvas_doodle"))},50),delete p}}}();
